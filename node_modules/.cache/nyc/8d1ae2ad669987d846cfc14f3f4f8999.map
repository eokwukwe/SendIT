{"version":3,"sources":["authentications.js"],"names":["Authenications","req","res","next","usertype","user","status","json","message"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;IACqBA,c;;;;;;;;AACnB;;;;;;;;2GAOuBC,G,EAAKC,G,EAAKC,I;;;;;;AACvBC,wB,GAAaH,IAAII,I,CAAjBD,Q;;sBAEJA,aAAa,O;;;;;iDACRF,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,2BAAS;AADiB,iBAArB,C;;;AAITL;;;;;;;;;;;;;;;;;AAGF;;;;;;;;;;;6GAOsBF,G,EAAKC,G,EAAKC,I;;;;;;AACtBC,wB,GAAaH,IAAII,I,CAAjBD,Q;;sBAEJA,aAAa,M;;;;;kDACRF,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,2BAAS;AADiB,iBAArB,C;;;AAITL;;;;;;;;;;;;;;;;;;;;kBAlCiBH,c","file":"authentications.js","sourceRoot":"/home/okwukwe/Desktop/Andela/sendIT/server/middleware","sourcesContent":["/** Authenications */\nexport default class Authenications {\n  /**\n   * Authenticate Admin\n   * @param {object} req\n   * @param {object} res\n   * @param {object} next\n   * @returns {object|void} response object\n   */\n  static async authAdmin(req, res, next) {\n    const { usertype } = req.user;\n\n    if (usertype !== 'admin') {\n      return res.status(403).json({\n        message: 'access denied. You are not authorised to view this content'\n      });\n    }\n    next();\n  }\n\n  /**\n   * Authenticate User\n   * @param {object} req\n   * @param {object} res\n   * @param {object} next\n   * @returns {object|void} response object\n   */\n  static async authUser(req, res, next) {\n    const { usertype } = req.user;\n\n    if (usertype !== 'user') {\n      return res.status(403).json({\n        message: 'access denied. You are not authorised to view this content'\n      });\n    }\n    next();\n  }\n}\n"]}