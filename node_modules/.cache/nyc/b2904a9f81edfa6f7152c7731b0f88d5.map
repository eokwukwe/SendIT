{"version":3,"sources":["verifyUserToken.js"],"names":["dotenv","config","verifyUserToken","req","res","next","token","headers","authorization","jwt","verify","process","env","JWT_SECRET","decoded","USER_TYPE","usertype","status","json","message","user"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;;;AAEAA,iBAAOC,MAAP;;AAEA;;;;;;;;AAQA,IAAMC;AAAA,sFAAkB,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBC,iBADgB,GACRH,IAAII,OAAJ,CAAYC,aADJ;AAAA;AAAA;AAAA,mBAGEC,uBAAIC,MAAJ,CAAWJ,KAAX,EAAkBK,QAAQC,GAAR,CAAYC,UAA9B,CAHF;;AAAA;AAGdC,mBAHc;;AAAA,kBAIhBH,QAAQC,GAAR,CAAYG,SAAZ,KAA0BD,QAAQE,QAJlB;AAAA;AAAA;AAAA;;AAAA,6CAKXZ,IAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,uBAAS;AADiB,aAArB,CALW;;AAAA;AASpBhB,gBAAIiB,IAAJ,GAAWN,OAAX;AACAT;AAVoB;AAAA;;AAAA;AAAA;AAAA;AAAA,6CAYbD,IAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,sBAAQ,YADkB;AAE1BE;AAF0B,aAArB,CAZa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBAmBejB,e","file":"verifyUserToken.js","sourceRoot":"/home/okwukwe/Desktop/Andela/sendIT/server/middleware","sourcesContent":["import jwt from 'jsonwebtoken';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\n/**\n * Verify User token\n * @static\n * @param {object} req -The request object\n * @param {object} res - The response object\n * @param {function} next\n * @returns {object}\n */\nconst verifyUserToken = async (req, res, next) => {\n  const token = req.headers.authorization;\n  try {\n    const decoded = await jwt.verify(token, process.env.JWT_SECRET);\n    if (process.env.USER_TYPE !== decoded.usertype) {\n      return res.status(401).json({\n        message: 'access denied!'\n      });\n    }\n    req.user = decoded;\n    next();\n  } catch (error) {\n    return res.status(401).json({\n      status: 'auth error',\n      message: error\n    });\n  }\n};\n\nexport default verifyUserToken;\n"]}