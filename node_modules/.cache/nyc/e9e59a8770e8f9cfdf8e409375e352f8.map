{"version":3,"sources":["verifyAdminToken.js"],"names":["dotenv","config","verifyAdminToken","req","res","next","token","headers","authorization","jwt","verify","process","env","JWT_SECRET","decoded","ADMIN_TYPE","usertype","status","json","message","user"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;;;AAEAA,iBAAOC,MAAP;;AAEA;;;;;;;;AAQA,IAAMC;AAAA,sFAAmB,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACjBC,iBADiB,GACTH,IAAII,OAAJ,CAAYC,aADH;AAAA;AAAA;AAAA,mBAGCC,uBAAIC,MAAJ,CAAWJ,KAAX,EAAkBK,QAAQC,GAAR,CAAYC,UAA9B,CAHD;;AAAA;AAGfC,mBAHe;;AAAA,kBAIjBH,QAAQC,GAAR,CAAYG,UAAZ,KAA2BD,QAAQE,QAJlB;AAAA;AAAA;AAAA;;AAAA,6CAKZZ,IAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,uBAAS;AADiB,aAArB,CALY;;AAAA;AASrBhB,gBAAIiB,IAAJ,GAAWN,OAAX;AACAT;AAVqB;AAAA;;AAAA;AAAA;AAAA;AAAA,6CAYdD,IAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,sBAAQ,YADkB;AAE1BE;AAF0B,aAArB,CAZc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAnB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBAmBejB,gB","file":"verifyAdminToken.js","sourceRoot":"/home/okwukwe/Desktop/Andela/sendIT/server/middleware","sourcesContent":["import jwt from 'jsonwebtoken';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\n/**\n * Verify Admin token\n * @static\n * @param {object} req -The request object\n * @param {object} res - The response object\n * @param {function} next\n * @returns {object}\n */\nconst verifyAdminToken = async (req, res, next) => {\n  const token = req.headers.authorization;\n  try {\n    const decoded = await jwt.verify(token, process.env.JWT_SECRET);\n    if (process.env.ADMIN_TYPE !== decoded.usertype) {\n      return res.status(401).json({\n        message: 'access denied! you are not authorized to visit this page'\n      });\n    }\n    req.user = decoded;\n    next();\n  } catch (error) {\n    return res.status(401).json({\n      status: 'auth error',\n      message: error\n    });\n  }\n};\n\nexport default verifyAdminToken;\n"]}